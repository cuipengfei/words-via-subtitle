# 字幕学单词 - 功能分析

## 应用概述

这是一个基于 WPF 的英语词汇学习应用程序，通过解析字幕文件（SRT/ASS）提取英语单词，并提供多种词典解释。支持视频同步播放和导出到 Bambook 电子书设备。

## 核心功能特性

### 1. 字幕文件解析

- **SRT 格式支持**：解析标准 SRT 字幕文件，提取英语单词和时间信息
- **ASS 格式支持**：解析高级字幕格式，支持复杂样式和时间轴
- **智能词汇提取**：使用正则表达式识别英语单词，过滤标点符号
- **时间同步**：保留每个单词在视频中的出现时间

### 2. 多源词典系统

- **本地词典**：内置 GRE 和 TOEFL 词汇库（11,333+单词），提供中文释义
- **必应翻译**：在线翻译服务，实时获取单词中文翻译
- **海词网词典**：集成 Dict.cn 网站，提供详细的在线词典查询
- **插件架构**：基于 MEF 框架的可扩展词典插件系统

### 3. 视频学习功能

- **视频同步播放**：根据字幕时间轴播放对应视频片段
- **语音合成**：文本转语音功能，支持单词发音
- **视频选择**：支持选择本地视频文件进行同步学习
- **播放控制**：集成媒体播放器控件

### 4. 学习管理系统

- **已知单词管理**：维护用户已掌握的词汇列表
- **单词标记**：支持标记单词为"已知"或"拼写错误"
- **智能过滤**：自动过滤已知单词，专注学习新词汇
- **学习进度跟踪**：记录学习历史和进度

### 5. 幻灯片演示模式

- **全屏展示**：全屏幕词汇学习演示模式
- **同步视频**：在幻灯片中同步播放视频片段
- **键盘导航**：支持键盘快捷键操作（ESC 退出）
- **词汇展示**：格式化显示单词和释义

### 6. Bambook 电子书导出

- **设备集成**：支持导出到 Bambook 电子书设备
- **格式转换**：生成 SNBC/SNBF 格式的电子书文件
- **截图功能**：自动生成词汇解释的截图
- **离线学习**：支持在电子书设备上离线学习

### 7. 用户界面设计

- **Ribbon 界面**：现代化的 Ribbon 风格用户界面
- **多语言支持**：界面支持中英文切换
- **图标系统**：完整的 UI 图标集，包括播放、发音、幻灯片等
- **响应式布局**：适应不同屏幕尺寸的界面设计

## 技术架构特点

### 8. 插件化架构设计

- **MEF 框架**：使用 Managed Extensibility Framework 实现插件系统
- **模块化设计**：字幕解析器和词典提供者均为独立插件
- **动态加载**：运行时动态发现和加载插件组件
- **接口规范**：定义标准接口确保插件兼容性

### 9. 开发环境与工具

- **Visual Studio 2010**：完整的解决方案包含 6 个项目
- **TFS 源码管理**：集成 Team Foundation Server 版本控制
- **自动化构建**：包含多套 TFS 构建模板
- **.NET Framework 3.5**：目标框架版本，兼容 Windows XP 及以上

### 10. 数据存储与管理

- **词汇数据库**：内置超过 11,000 个 TOEFL 和 GRE 词汇
- **用户数据**：本地存储已知单词列表
- **配置管理**：XML 格式的应用程序配置文件
- **资源管理**：嵌入式资源文件管理图标和模板

### 11. 第三方集成

- **Bambook 设备**：专用的电子书阅读器集成
- **必应翻译 API**：微软翻译服务集成
- **WPF 工具包**：扩展 WPF 控件库
- **语音合成**：Windows 语音 API 集成

## 项目历史与背景

### 12. 开发历史

- **开源协议**：Apache License 2.0
- **开发者**：崔鹏飞（从 Bambook 模板文件可见）

### 13. 文件结构统计

- **总文件数量**：87 个文件
- **源代码文件**：62 个文本文件（C#、XAML、配置等）
- **资源文件**：25 个二进制文件（图标、DLL、可执行文件等）
- **项目结构**：6 个独立项目组成的完整解决方案

## 应用价值与特色

### 14. 创新特点

- **字幕学习法**：通过影视字幕学习英语词汇的创新方法
- **多媒体整合**：视频、音频、文本的完美结合
- **离线学习**：支持导出到电子书设备进行离线学习
- **个性化学习**：根据用户已知词汇智能过滤学习内容

### 15. 技术先进性

- **插件化设计**：2010 年就采用了现代化的插件架构
- **多源整合**：整合本地词典、在线翻译、网络词典多种资源
- **设备集成**：与专用硬件设备的深度集成
- **用户体验**：现代化的 Ribbon 界面设计

## 总结

这是一个功能完整、设计先进的英语词汇学习应用程序，体现了 2010 年代初期软件开发的高水准。通过字幕文件学习英语词汇的创新方法，结合多种词典资源和视频同步功能，为用户提供了沉浸式的语言学习体验。插件化架构设计使得应用具有良好的扩展性，而与 Bambook 电子书设备的集成则展现了对移动学习场景的前瞻性考虑。
